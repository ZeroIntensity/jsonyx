{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "https://raw.githubusercontent.com/nineteendo/jsonyx/v1.3.x/json-patch.schema.json",
    "definitions": {
        "operation": {
            "description": "A JSON patch operation.",
            "type": "object",
            "properties": {
                "op": {
                    "description": "The operation to perform.",
                    "type": "string",
                    "enum": ["append", "assert", "clear", "del", "extend", "insert", "reverse", "set", "update"]
                },
                "path": {
                    "description": "A path expression.",
                    "type": "string",
                    "default": "$"
                }
            },
            "required": ["op", "path"],
            "allOf": [
                {
                    "if": {
                        "properties": {"op": {"enum": ["append", "extend", "insert", "set", "update"]}},
                        "required": ["op"]
                    },
                    "then": {
                        "properties": {"value": {"description": "The value to use."}},
                        "required": ["value"]
                    }
                },
                {
                    "if": {
                        "properties": {"op": {"const": "assert"}},
                        "required": ["op"]
                    },
                    "then": {
                        "properties": {
                            "expr": {
                                "description": "The expression to validate.",
                                "type": "string",
                                "default": "@"
                            }
                        },
                        "required": ["expr"]
                    }
                }
            ],
            "unevaluatedProperties": false
        }
    },
    "anyOf": [
        {
            "$ref": "#/definitions/operation"
        },
        {
            "type": "array",
            "items": {"$ref": "#/definitions/operation"}
        }
    ]
}